<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Communication over jpip demo</title>
    <link rel="stylesheet" href="./css/webgl.css" type="text/css"> 
    <!-- <link rel="stylesheet" href="./css/aaccordion.css" type="text/css"> -->
    <link rel="stylesheet" href="./css/tabs.css" type="text/css">   
    <script src="./js/globals.js" type="text/javascript"></script>
    <script src="./js/sylvester.js" type="text/javascript"></script>
    <script src="./js/glUtils.js" type="text/javascript"></script>
    <script src="../src/js/jpip.js" type="text/javascript"></script>
    <script src="./js/solarJPIP.js" type="text/javascript"></script>
    <script src="./js/webgl.js" type="text/javascript"></script>
    <script src="./js/gui.js" type="text/javascript"></script>
    <script src="./js/viewports.js" type="text/javascript"></script>
    <script src="./js/mouse.js" type="text/javascript"></script>

    <script id="shader-fs" type="x-shader/x-fragment">
      varying highp vec2 vTextureCoord;
      varying highp vec2 vTextureCoordDiff;

      uniform sampler2D uSampler;
      uniform sampler2D uSamplerDiff;

      uniform sampler2D uColormap;
      uniform highp float colorTableValue;
      uniform highp float boostboxValue;
      uniform highp float alphaValue;
      uniform int isDiff;
      
      void main(void) {
	    if(isDiff==1){
          gl_FragColor = texture2D(uSampler, vTextureCoord) - texture2D(uSamplerDiff, vTextureCoordDiff);
		  highp float val = clamp((clamp(gl_FragColor.x, -boostboxValue, boostboxValue)/boostboxValue + 1.)/2., 0. , 1.);
		  gl_FragColor.xyz = vec3(val,val,val);
		}
        else{
		  gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
		}

        gl_FragColor = texture2D(uColormap, vec2(gl_FragColor.r, colorTableValue));

        gl_FragColor.a = alphaValue;
      }
    </script>
 
    <script id="shader-vs" type="x-shader/x-vertex">
      attribute vec3 aVertexPosition;
      attribute vec2 aTextureCoord;

    
      uniform mat4 uMVMatrix;
      uniform mat4 uPMatrix;
      uniform vec2 center;
      uniform vec2 centerDiff;
      uniform vec2 stretch;
      uniform vec2 stretchDiff;
      
      varying highp vec2 vTextureCoord;
      varying highp vec2 vTextureCoordDiff;
   
      void main(void) {
        gl_Position =  vec4(aVertexPosition.x*stretch.x, aVertexPosition.y*stretch.y, 0. , 1.0);
		gl_Position = uMVMatrix * gl_Position;
        vTextureCoord = aTextureCoord;// + vec2(center.x, -center.y);
        vTextureCoordDiff = aTextureCoord + vec2(centerDiff.x, -centerDiff.y);

      }
    </script>
    <script id="shader-fs-limb" type="x-shader/x-fragment">
      varying highp vec2 vTextureCoord;
      varying highp vec2 vTextureCoordDiff;

      uniform sampler2D uSampler;
      uniform sampler2D uSamplerDiff;

      uniform sampler2D uColormap;
      uniform highp float colorTableValue;
      uniform highp float boostboxValue;
      uniform highp float alphaValue;
      uniform int isDiff;
      
      void main(void) {
	    if(isDiff==1){
          gl_FragColor = texture2D(uSampler, vTextureCoord) - texture2D(uSamplerDiff, vTextureCoordDiff);
		  highp float val = clamp((clamp(gl_FragColor.x, -boostboxValue, boostboxValue)/boostboxValue + 1.)/2., 0. , 1.);
		  gl_FragColor.xyz = vec3(val,val,val);
		}
        else{
		  gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
		}

        gl_FragColor = texture2D(uColormap, vec2(gl_FragColor.r, colorTableValue));

        gl_FragColor.a = alphaValue;
      }
    </script>
     
    <script id="shader-vs-limb" type="x-shader/x-vertex">
      attribute vec3 aVertexPosition;
      attribute vec2 aTextureCoord;

    
      uniform mat4 uMVMatrix;
      uniform mat4 uPMatrix;
      uniform vec2 center;
      uniform vec2 centerDiff;
      uniform vec2 stretch;
      uniform vec2 stretchDiff;
      
      varying highp vec2 vTextureCoord;
      varying highp vec2 vTextureCoordDiff;
   
      void main(void) {
        gl_Position =  vec4(aVertexPosition , 1.0);
		gl_Position = uMVMatrix * gl_Position;
        vTextureCoord = aTextureCoord;// + vec2(center.x, -center.y);
        vTextureCoordDiff = aTextureCoord + vec2(centerDiff.x, -centerDiff.y);

      }
    </script>
  </head>
  
  <body>
  	<div style = "float:left;">
    <section class="tab-area tabs-checked">
		<input class="tabinput" checked="" type="radio" name="tab" id="tab-A">
		<input class="tabinput" type="radio" name="tab" id="tab-B">
		<input class="tabinput" type="radio" name="tab" id="tab-C">

		<label class="tab-link" for="tab-A">Dataset</label>
		<label class="tab-link" for="tab-B">Viewport</label>
		<label class="tab-link" for="tab-C">Layer</label>

		<article class="tab">
			<h3>Dataset options</h3>   
	      <div id ="datePanel"></div> 

          <p>     	      
		  <div id ="controlpanel"></div> 
		  <div id ="local_controlpanel"></div>
		</article>
		<article class="tab">
			<h3>Viewport options</h3>
		      <div id ="viewport"></div>  
		      <div id ="viewportDiv"></div>
		</article>
		<article class="tab">
			<h3>Layer options</h3>
			  <div id="wrap">
			  	  <div><ul id="layers"></ul></div>
			      <div id="info">
			      </div>
			      <div id ="imagepanel">
			      </div>
			      <div id="metadata">
			      </div>
			      <div id="fps">
			      </div>
			  </div>
		</article>
	</section>
 	</div>    
	 <div style="margin-left:1em;float:left;">
	 	<div id ="videoPlayButton" class="video" data-tips="Play/Pause video"><img src="images/play.png"/>
	 	</div><div id="videoBarWrap"><div class="video" id="videoBar"></div><div id="videoIndicator"></div>
	 	</div><div></div><div class="video" id="videoStart" data-tips="Jump to start"><img src="images/first.png"/>
	 	</div><div class="video" id="videoPrevious" data-tips="Step backward in time"><img src="images/previous.png"/>
	 	</div><div class="video" id="videoNext" data-tips="Step forward in time"><img src="images/next.png"/>
	 	</div><div class="video" id="videoEnd" data-tips="Jump to end"><img src="images/last.png"/>
	 	</div>
	 	<div id="gllcanvaswrap" style="width:550px; height:512px;">	
	    <canvas id="glcanvas" width="512" height="512">
	      Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
	    </canvas>
	   </div>
	 </div>

</body>
</html>
